<div class="content">
  <h1><%= @post.user.email %></h1>
  <p><%= @post.body %></p>

  <div class="buttons">
    <% if current_user.liked_posts.include?(@post) %>
      <%= simple_form_for :unlike, url: like_path(current_user.likes.find_by_post_id(@post.id)), method: :delete do |f| %>
        <%= f.submit 'Unlike', class: 'button is-link is-outlined' %>
      <% end %>
    <% else %>
      <%= simple_form_for :like, url: likes_path, method: :post do |f| %>
        <%= f.hidden_field :post_id, value: @post.id %>
        <%= f.submit 'Like', class: 'button is-link' %>
      <% end %>
    <% end %>
    <p class="title is-4 has-text-link"><%= @post.likes.count %></p>
  </div>

  <% @post.comments.includes(:user).each do |comment| %>
    <strong><%= comment.user.email %></strong>
    <p><%= comment.body %></p>
    <% if current_user == comment.user %>
    <div class="buttons">
      <%= link_to 'Edit Comment', edit_post_comment_path(@post, comment), class: 'button is-info' %>
      <%= link_to 'Delete Comment', post_comment_path(@post, comment), method: :delete, data: { confirm: 'Are you sure?' }, class: 'button is-danger' %>
    </div>
    <% end %>
  <% end %>

  <%= simple_form_for @comment, url: post_comments_path(@post) do |f| %>
    <%= f.error_notification %>
    <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

    <div class="form-inputs field">
      <div class="control">
        <%= f.input :body, input_html: { class: "textarea"}, wrapper: false, label_html: {class: "label"} %>
      </div>
    </div>

    <div class="form-actions field">
      <div class="control">
        <%= f.button :submit, class: "button is-info" %>
      </div>
    </div>
  <% end %>
  
  <div class="buttons">
    <% if current_user == @post.user %>
    <%= link_to 'Edit Post', edit_post_path(@post), class: 'button is-info' %>
    <% end %>
    <%= link_to 'Back', posts_path, class: 'button is-light' %>
    <% if current_user == @post.user %>
    <%= link_to 'Delete Post', @post, method: :delete, data: { confirm: 'Are you sure?' }, class: 'button is-danger left' %>
    <% end %>
  </div>
</div>
